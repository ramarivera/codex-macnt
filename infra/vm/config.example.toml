# Example VM orchestration configuration.
# Copy this file to ~/.config/codex-vm/config.toml and update for your environment.

# Remote machine (VirtualBox host)
host = "vbox-host"
user = "builder"
ssh_port = 22
ssh_key = "~/.ssh/id_ed25519"

# Shared directories on the remote host
base_dir = "~/codex-vm"
artifact_dir = "~/codex-vm/artifacts"
guest_key = "~/.ssh/id_ed25519"

# Reuse existing VMs by default; set to "recreate" for clean bootstraps.
lifecycle_mode = "reuse"

# Auth policy for Linux guest SSH.
# If set, overrides only the bootstrap user candidate list used when probing.
# Comma-separated list (for example "builder,ubuntu,root"). Empty falls back to:
# "<linux_guest_user>,ubuntu,root".
guest_auth_users = ""

# Retry behavior for Linux guest auth failures.
# Set to 1 (default) for one automatic recreate retry on auth failure.
# Set to 0 to fail fast if all candidates fail.
retry_recreate_on_auth_failure = "1"

# Build inputs
codex_dmg_url = "https://persistent.oaistatic.com/codex-app-prod/Codex.dmg"
codex_git_ref = "rust-v0.102.0-alpha.5"
enable_linux_ui_polish = "1"
skip_rust_build = "1"
skip_rebuild_native = "1"
prebuilt_cli_url = ""
prebuilt_sandbox_url = ""
prebuilt_win_cli_url = ""
linux_iso_url = "https://releases.ubuntu.com/24.04/ubuntu-24.04.4-live-server-amd64.iso"

# Optional: path to a local copy of the Windows ISO on the remote host
windows_iso_path = ""

# Linux VM configuration
linux_vm_name = "codex-linux-builder"
linux_ostype = "Ubuntu_64"
linux_disk_gb = 80
linux_cpus = 4
linux_memory_mb = 8192
linux_base_ova = "/mnt/isos/ubuntu-server-24.04.ova"
linux_base_iso = ""
use_default_ubuntu_template = "0"
linux_ssh_port = 2222
linux_workspace = "/home/ramarivera/codex-linux"
linux_guest_user = "builder"
linux_guest_password = "change-me"

# Windows VM configuration
windows_vm_name = "codex-windows-builder"
windows_ostype = "Windows2019_64"
windows_disk_gb = 120
windows_cpus = 6
windows_memory_mb = 12288
windows_base_ova = ""
windows_base_iso = ""
windows_ssh_port = 2232
windows_workspace = "/c/codex-windows/codex-linux"
windows_guest_user = "builder"
windows_guest_password = "change-me"

# Local output behavior
local_output_dir = "infra/vm/artifacts"
